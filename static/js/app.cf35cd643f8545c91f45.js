webpackJsonp([1],{"1Zey":function(t,a){},"47pd":function(t,a){},"7zck":function(t,a){},K7Ib:function(t,a){},NHnr:function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var r=e("7+uW"),n=e("3EgV"),o=e.n(n),i=(e("7zck"),e("VIAY")),s=e.n(i),c=e("Dd8w"),d=e.n(c),u={components:{VueDraggableResizable:s.a},props:{chordData:{type:Object,required:!0},rowId:{type:String,required:!0}},computed:{},data:function(){return{}},methods:{onDrop:function(t){this.$store.dispatch("updateChordData",{rowId:this.rowId,id:this.chordData.id,text:this.chordData.text,x:t})},activateChord:function(){this.$store.dispatch("updateActiveChord",d()({},this.chordData,{rowId:this.rowId}))}}},h={render:function(){var t=this.$createElement,a=this._self._c||t;return a("vue-draggable-resizable",{staticClass:"chord",attrs:{w:51,x:this.chordData.x,parent:!0,axis:"x",resizable:!1},on:{dragstop:this.onDrop}},[a("v-chip",{attrs:{label:""},on:{click:this.activateChord}},[this._v(this._s(this.chordData.text))])],1)},staticRenderFns:[]};var l={components:{Chord:e("VU/8")(u,h,!1,function(t){e("WqFK")},"data-v-6ec87d41",null).exports},props:{chordList:{type:Array,required:!0},rowId:{type:String,required:!0}},computed:{},data:function(){return{}},methods:{addChord:function(){this.$store.dispatch("createChord",this.rowId)}}},f={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("v-layout",[e("v-flex",{staticClass:"chords-container"},t._l(t.chordList,function(a,r){return e("chord",{key:r,attrs:{chordData:a,rowId:t.rowId}})})),t._v(" "),e("v-btn",{staticClass:"button-chord-add",attrs:{small:"",fab:"",dark:"",color:"indigo"},on:{click:t.addChord}},[e("v-icon",{attrs:{dark:""}},[t._v("add")])],1)],1)},staticRenderFns:[]};var p={components:{ChordList:e("VU/8")(l,f,!1,function(t){e("VSNR")},"data-v-dd7aa168",null).exports},props:{tablatureRowData:{type:Object,required:!0}},computed:{},data:function(){return{}},methods:{updateText:function(t){this.$store.dispatch("updateTablatureRow",{id:this.tablatureRowData.id,text:t})}}},v={render:function(){var t=this.$createElement,a=this._self._c||t;return a("v-layout",{attrs:{column:""}},[a("chord-list",{attrs:{chordList:this.tablatureRowData.chords,rowId:this.tablatureRowData.id}}),this._v(" "),a("v-flex",{staticClass:"row-text-container"},[a("v-text-field",{staticClass:"row-text",attrs:{value:this.tablatureRowData.text},on:{input:this.updateText}})],1)],1)},staticRenderFns:[]};var C={components:{TablatureRow:e("VU/8")(p,v,!1,function(t){e("47pd")},"data-v-5e3bd66d",null).exports},computed:{tablatureData:function(){return this.$store.getters.tablatureData}},data:function(){return{}},methods:{}},b={render:function(){var t=this.$createElement,a=this._self._c||t;return a("v-container",{staticClass:"list-container"},this._l(this.tablatureData,function(t,e){return a("tablature-row",{key:e,attrs:{column:"",tablatureRowData:t}})}))},staticRenderFns:[]};var x=e("VU/8")(C,b,!1,function(t){e("jL+E")},"data-v-2f1116c2",null).exports,m={render:function(){var t=this.$createElement,a=this._self._c||t;return a("v-layout",{attrs:{column:""}},[a("v-flex",{staticClass:"edit-container"},[a("v-text-field",{staticClass:"chord-text",attrs:{label:"Chord text",value:this.activeChordData?this.activeChordData.text:""},on:{input:this.updateText}}),this._v(" "),a("v-btn",{attrs:{color:"error"},on:{click:this.deleteChord}},[this._v("Delete")])],1)],1)},staticRenderFns:[]};var D=e("VU/8")({components:{},computed:{activeChordData:function(){return this.$store.getters.activeChordData}},data:function(){return{}},methods:{updateText:function(t){this.$store.dispatch("updateChordData",{id:this.activeChordData.id,rowId:this.activeChordData.rowId,text:t})},deleteChord:function(){this.$store.dispatch("deleteChord")}}},m,!1,function(t){e("K7Ib")},"data-v-ac7e9ec4",null).exports,w=e("lDdF"),g=e.n(w),T={components:{},computed:{tablatureData:function(){return this.$store.getters.tablatureData}},data:function(){return{tablatureText:"",newTablatureData:[],widthChord:51,paddingChord:17,coefFirstChord:.16,coefChord:.15}},methods:{onSaveTablature:function(){this.createTablatureText();var t=new Blob([this.tablatureText],{type:"text/plain;charset=utf-8"});g.a.saveAs(t,"tablature.txt"),this.tablatureText=""},createTablatureText:function(){var t=this;this.tablatureData.forEach(function(a,e){var r=a.chords.slice().sort(t.sortChords);t.createRowChords(r,e),t.tablatureText+="\r\n"+a.text})},sortChords:function(t,a){return t.x-a.x},addSpace:function(t){for(var a=0;a<t;a+=1)this.tablatureText+=" "},createRowChords:function(t,a){var e=this;0!==a&&(this.tablatureText+="\r\n"),t.forEach(function(a,r){e.addSpace(e.calcCountSpace(r,a,t)),e.tablatureText+=a.text})},calcCountSpace:function(t,a,e){return 0!==t?Math.round((a.x-e[t-1].x-(this.widthChord-this.paddingChord))*this.coefChord):Math.round((a.x+this.paddingChord)*this.coefFirstChord)},onOpenFile:function(t){var a=this;this.$store.commit("setLoading",!0);var e=t.target.files[0],r=new FileReader;r.onload=function(){a.createTablatureData(r.result),a.$store.dispatch("uploadTablatureData",a.newTablatureData)},r.readAsText(e),this.newTablatureData=[]},createTablatureData:function(t){for(var a=t.split("\r\n"),e=Math.round(a.length/2),r=0;r<e;r+=1)this.createTablatureRowData(a,r)},createTablatureRowData:function(t,a){this.newTablatureData.push({id:this.generateId(),text:t[2*a+1],chords:this.createTablatureChordsData(t[2*a])})},createTablatureChordsData:function(t){var a=this;if(t.length>0){var e=t.match(/\s+/g).map(function(t){return t.length}),r=[];return t.match(/\w+/g).forEach(function(t,n){r.push({id:a.generateId(),text:t,x:a.calcPositionChord(e,n,r)})}),r}return[]},generateId:function(){return"_"+Math.random().toString(36).substr(2,9)},calcPositionChord:function(t,a,e){return 0!==a?Math.floor(t[a]/this.coefChord+e[a-1].x+(this.widthChord-this.paddingChord)):Math.floor(t[a]/this.coefFirstChord-this.paddingChord)}}},_={render:function(){var t=this.$createElement,a=this._self._c||t;return a("v-flex",{staticClass:"buttons-file-control"},[a("label",{staticClass:"custom-file-open",attrs:{for:"file-open"}},[a("v-btn",{staticClass:"button-file-open",attrs:{color:"info"}},[this._v("Open")])],1),this._v(" "),a("input",{attrs:{id:"file-open",type:"file"},on:{change:this.onOpenFile}}),this._v(" "),a("v-btn",{attrs:{color:"success"},on:{click:this.onSaveTablature}},[this._v("Save")])],1)},staticRenderFns:[]};var R={components:{SectionEditChord:D,ControlFile:e("VU/8")(T,_,!1,function(t){e("1Zey")},"data-v-7c4d2faa",null).exports},computed:{activeChordData:function(){return this.$store.getters.activeChordData}},data:function(){return{}},methods:{}},I={render:function(){var t=this.$createElement,a=this._self._c||t;return a("v-layout",{staticClass:"control-panel",attrs:{column:""}},[a("control-file"),this._v(" "),a("section-edit-chord",{directives:[{name:"show",rawName:"v-show",value:this.activeChordData,expression:"activeChordData"}]})],1)},staticRenderFns:[]};var $={components:{TablatureList:x,ControlSection:e("VU/8")(R,I,!1,function(t){e("TCoE")},"data-v-82eb832c",null).exports},computed:{loading:function(){return this.$store.getters.loading}},data:function(){return{}},methods:{}},y={render:function(){var t=this.$createElement,a=this._self._c||t;return a("v-container",{staticClass:"main-container"},[a("v-layout",{attrs:{row:""}},[this.loading?this._e():a("tablature-list"),this._v(" "),this.loading?a("v-container",{staticClass:"progress-container"},[a("v-layout",[a("v-flex",{staticClass:"text-xs-center",attrs:{xs12:""}},[a("v-progress-circular",{staticClass:"primary--text",attrs:{indeterminate:"",width:7,size:70}})],1)],1)],1):this._e(),this._v(" "),a("control-section")],1)],1)},staticRenderFns:[]};var F={data:function(){return{}},name:"App",components:{Tablature:e("VU/8")($,y,!1,function(t){e("q1W4")},"data-v-41f7d7d7",null).exports}},E={render:function(){var t=this.$createElement,a=this._self._c||t;return a("v-app",[a("tablature")],1)},staticRenderFns:[]},S=e("VU/8")(F,E,!1,null,null,null).exports,V=e("NYxO");r.a.use(V.a);var L=new V.a.Store({state:{tablatureData:[{id:"1",chords:[],text:""},{id:"2",chords:[],text:""},{id:"3",chords:[],text:""},{id:"4",chords:[],text:""},{id:"5",chords:[],text:""},{id:"6",chords:[],text:""}],activeChord:null,loading:!1},actions:{updateChordData:function(t,a){(0,t.commit)("updateChord",a)},updateTablatureRow:function(t,a){(0,t.commit)("updateTablatureRow",a)},createChord:function(t,a){var e=t.commit,r={id:String(Date.now()),text:"text",x:0};e("createChord",d()({},r,{rowId:a}))},updateActiveChord:function(t,a){(0,t.commit)("updateActiveChord",a)},uploadTablatureData:function(t,a){var e=t.commit;e("uploadTablatureData",a),e("setLoading",!1)},deleteChord:function(t){var a=t.commit;a("setLoading",!0),setTimeout(function(){a("deleteChord"),a("setLoading",!1)},0)}},mutations:{updateChord:function(t,a){var e=t.tablatureData.find(function(t){return t.id===a.rowId}).chords.find(function(t){return t.id===a.id});a.text&&(e.text=a.text),a.x&&(e.x=a.x)},updateTablatureRow:function(t,a){var e=t.tablatureData.find(function(t){return t.id===a.id});a.text&&(e.text=a.text)},createChord:function(t,a){var e=t.tablatureData.find(function(t){return t.id===a.rowId}),r=a;delete r.rowId,e.chords.push(r)},updateActiveChord:function(t,a){t.activeChord=a},uploadTablatureData:function(t,a){t.tablatureData=a},setLoading:function(t,a){t.loading=a},deleteChord:function(t){var a=t.tablatureData.find(function(a){return a.id===t.activeChord.rowId});a.chords.find(function(e,r){return e.id===t.activeChord.id&&(a.chords.splice(r,1),t.activeChord=null,e)})}},getters:{tablatureData:function(t){return t.tablatureData},activeChordData:function(t){return t.activeChord},loading:function(t){return t.loading}}});r.a.use(o.a),r.a.component("vue-draggable-resizable",s.a),r.a.config.productionTip=!1,new r.a({store:L,el:"#app",components:{App:S},template:"<App/>"})},TCoE:function(t,a){},VSNR:function(t,a){},WqFK:function(t,a){},"jL+E":function(t,a){},q1W4:function(t,a){}},["NHnr"]);
//# sourceMappingURL=app.cf35cd643f8545c91f45.js.map